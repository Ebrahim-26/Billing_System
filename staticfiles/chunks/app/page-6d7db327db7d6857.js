(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5164:function(e,t,l){Promise.resolve().then(l.t.bind(l,5878,23)),Promise.resolve().then(l.bind(l,9892))},2587:function(e,t,l){"use strict";var a=l(7437),o=l(6387),n=l(4013);l(2265);var r=l(3919),i=l(6940);t.Z=function(e){let{children:t,variant:l,startIcon:s,endIcon:d,sx:c,fontSize:u,onClick:m,disabled:f,type:p,...x}=e,b=(0,i.p)();return(0,r.a)(),(0,a.jsx)("div",{className:"w-[100%] h-[100%] ",children:(0,a.jsxs)(n.Z,{type:p,fullWidth:!0,disabled:f,onClick:m,variant:l,sx:{height:"100%",width:"100%",...c},...x,children:[s&&(0,a.jsx)("span",{style:{marginRight:0},children:s}),(0,a.jsx)(o.Z,{sx:{textTransform:"none",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",...b.b4},children:t}),d&&(0,a.jsx)("span",{style:{marginLeft:8},children:d})]})})}},3084:function(e,t,l){"use strict";var a=l(7437),o=l(2713);l(2265),t.Z=function(e){let{value:t,setValue:l,label:n,type:r,variant:i,readOnly:s=!1}=e;return(0,a.jsx)(o.Z,{type:r,onChange:e=>l(e.target.value),id:"filled-basic",label:n,variant:i,value:t||"",InputProps:{readOnly:s},sx:{width:"100%","& label":{color:"grey"},"& label.Mui-focused":{color:"black"},"& .MuiFilledInput-root":{backgroundColor:""},"& .MuiFilledInput-underline:before":{borderBottomColor:"grey"},"& .MuiFilledInput-underline:after":{borderBottomColor:"black"}}})}},9892:function(e,t,l){"use strict";l.d(t,{default:function(){return z}});var a=l(7437),o=l(2265),n=l(4099),r=l(2713),i=function(e){let{label:t,width:l,data:o,disabled:i,borderRadius:s,setSelectedData:d}=e;return(0,a.jsx)("div",{className:"w-full transition-all",children:(0,a.jsx)(n.Z,{disablePortal:!0,options:o,disabled:i,onChange:(e,t)=>{d(t)},getOptionLabel:e=>e.name,renderOption:(e,t)=>{let{key:l,...o}=e;return(0,a.jsxs)("li",{...o,children:[" ",t.name]},t.id)},renderInput:e=>(0,a.jsx)(r.Z,{...e,label:t,sx:{color:"black",width:{width:l},"& label":{color:"black"},"& label.Mui-focused":{color:"black"},borderRadius:"12px","& .MuiOutlinedInput-root":{borderRadius:{borderRadius:s},"&.Mui-focused fieldset":{borderColor:"black"}}}})})})},s=function(e){let{setCounter:t,counter:l}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-center   border border-[#9a9b9e] rounded-sm ",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{t(e=>e>0?e-1:0)},className:"text-lg font-semibold text-black px-2 m-1 hover:bg-slate-100 border-1 border-black rounded-md",children:"-"}),(0,a.jsx)("input",{type:"number",value:l,readOnly:!0,className:"text-center text-lg font-semibold border border-gray-300 rounded-lg w-16"}),(0,a.jsx)("button",{type:"button",onClick:()=>{t(e=>e+1)},className:"text-lg font-semibold text-black px-2 m-1 hover:bg-slate-400 border-1 border-black rounded-md",children:"+"})]})},d=l(2587),c=l(2069),u=l(20),m=l(2187),f=l(1327),p=l(7064);function x(e){let{label:t,data:l,setSelectedData:o,selectedData:n}=e;return(0,a.jsx)(c.Z,{sx:{width:"100%"},children:(0,a.jsxs)(f.Z,{fullWidth:!0,sx:{"& .MuiInputLabel-root":{color:"grey"},"& .MuiInputLabel-root.Mui-focused":{color:"black"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"grey"},"&:hover fieldset":{borderColor:"#1f1f1f"},"&.Mui-focused fieldset":{borderColor:"black"}}},children:[(0,a.jsx)(u.Z,{id:"demo-simple-select-label",children:t}),(0,a.jsx)(p.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n||"",label:t,onChange:e=>{o(e.target.value)},children:null==l?void 0:l.map((e,t)=>(0,a.jsx)(m.Z,{value:e.id,children:e.name},t))})]})})}var b=l(3989),h=l(9250),g=l(7348);function v(e){let{label:t,value:l,setSelectedData:o,readOnly:n=!1}=e;return(0,a.jsx)(h._,{dateAdapter:b.y,children:(0,a.jsx)(g.M,{readOnly:n,sx:{width:"100%"},label:t,value:l,onChange:e=>o(e)})})}var y=l(3084),j=l(1096),S=l.n(j),w=l(3464),k=l(9901),C=l(2641),_=l(9376),Z=l(8004),N=function(e){let{paymentModeModal:t,setPaymentModeModal:l}=e,[n,r]=(0,o.useState)(),[i,s]=(0,o.useState)(!1),u=async()=>{if(!i){s(!0);try{let e=await w.Z.post("http://localhost:8000/api/payment_modes/",{name:n},{headers:{"Content-Type":"application/json"}});201===e.status?(l(!1),r("")):console.log("Unexpected response:",e.status)}catch(t){var e;console.error("Error posting data:",(null===(e=t.response)||void 0===e?void 0:e.data)||t.message)}finally{s(!1)}}};return(0,a.jsx)("form",{onSubmit:u,children:(0,a.jsx)(Z.Z,{open:t,onClose:()=>{l(!1),r("")},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,a.jsx)(c.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"30rem",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,borderRadius:"5px"},children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-[1rem]",children:[(0,a.jsx)(y.Z,{label:"Payment Mode",value:n,setValue:r}),(0,a.jsx)(d.Z,{onClick:u,type:"submit",sx:{backgroundColor:"black",color:"white"},children:"Add Payment Mode"})]})})})})},M=function(e){let{paymentTermModal:t,setPaymentTermModal:l}=e,[n,r]=(0,o.useState)(),[i,s]=(0,o.useState)(!1),u=async()=>{if(!i){s(!0);try{let e=await w.Z.post("http://localhost:8000/api/payment_terms/",{name:n},{headers:{"Content-Type":"application/json"}});201===e.status?(l(!1),setPaymentMode("")):console.log("Unexpected response:",e.status)}catch(t){var e;console.error("Error posting data:",(null===(e=t.response)||void 0===e?void 0:e.data)||t.message)}finally{s(!1)}}};return(0,a.jsx)("form",{onSubmit:u,children:(0,a.jsx)(Z.Z,{open:t,onClose:()=>{l(!1),r("")},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,a.jsx)(c.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"30rem",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,borderRadius:"5px"},children:(0,a.jsxs)("div",{className:"flex flex-col gap-y-[1rem]",children:[(0,a.jsx)(y.Z,{label:"Payment Term",value:n,setValue:r}),(0,a.jsx)(d.Z,{onClick:u,type:"submit",sx:{backgroundColor:"black",color:"white"},children:"Add Payment Term"})]})})})})},z=function(){let e=(0,_.useRouter)(),{loginOpen:t}=(0,k.O)(),[l,n]=(0,o.useState)(),[r,c]=(0,o.useState)(),[u,m]=(0,o.useState)(1),[f,p]=(0,o.useState)(),[b,h]=(0,o.useState)(),[g,j]=(0,o.useState)(1),[Z,z]=(0,o.useState)(S()()),[W,I]=(0,o.useState)(),[P,E]=(0,o.useState)([]),[O,D]=(0,o.useState)(),[T,F]=(0,o.useState)(!1),[L,A]=(0,o.useState)(!1),[B,R]=(0,o.useState)(),[U,Y]=(0,o.useState)([]),[q,J]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(async()=>{try{let e=await w.Z.get("http://localhost:8000/api/get-invoice-fields/",{withCredentials:!0});R(e.data)}catch(e){console.error("Error posting data:",e)}finally{}})()},[t]);let[V,G]=(0,o.useState)({number:null,date:null,client_id:null,service_details:null,payment_mode_id:null,payment_term_id:null,estimated_completion_date:null,authorizer_id:null,total_amount:"0.00",status:"unsettled"});(0,o.useEffect)(()=>{(()=>{let e=P.reduce((e,t)=>e+t.cost*t.quantity,0);G(t=>({...t,total_amount:e.toFixed(2)}))})()},[P]),(0,o.useEffect)(()=>{B&&b&&G(e=>({...e,number:"".concat(function(e){if(!e)return"";let t=e.trim().split(" ");return 1===t.length?t[0].slice(0,2).toUpperCase():t[0][0].toUpperCase()+t[1][0].toUpperCase()}(null==b?void 0:b.name)).concat(B.invoice_number),date:null==Z?void 0:Z.format("YYYY-MM-DD"),client_id:b.id,payment_mode_id:r,payment_term_id:u,estimated_completion_date:null==W?void 0:W.format("YYYY-MM-DD"),authorizer_id:f}))},[B,b,Z,r,u,W,f]),(0,o.useEffect)(()=>{G(e=>({...e,amount_paid:O||"0.00"}))},[O]),(0,o.useEffect)(()=>{G(e=>({...e,service_details:[...U]}))},[U]);let H=async t=>{if(t.preventDefault(),!q){J(!0);try{let t=await w.Z.post("http://localhost:8000/api/invoices/",V);201===t.status?e.push("invoice/".concat(t.data.id)):console.log("Error generating invoice")}catch(e){console.error("Error posting data:",e),alert("Failed to generate invoice. Please try again.")}finally{J(!1)}}};return(0,a.jsx)("form",{onSubmit:H,children:(0,a.jsxs)("div",{className:"p-10 w-[100%] border-2 border-black rounded-md shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex gap-5 w-[100%]",children:[(0,a.jsx)(y.Z,{id:"filled-basic",label:"Invoice Number",variant:"filled",value:(null==V?void 0:V.number)||"",readOnly:!0}),(0,a.jsx)(v,{label:"Date",value:Z,setSelectedData:z,readOnly:!0})]}),(0,a.jsx)("div",{className:"my-5 ",children:(0,a.jsx)(i,{setSelectedData:h,label:"Select Clients",data:null==B?void 0:B.clients})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex my-5 gap-5",children:[(0,a.jsx)("div",{className:"w-[100%]",children:(0,a.jsx)(i,{setSelectedData:n,label:"Services",data:null==B?void 0:B.services})}),(0,a.jsx)(s,{counter:g,setCounter:j}),(0,a.jsx)("div",{className:"",children:(0,a.jsx)(d.Z,{type:"button",onClick:()=>{let e=P.findIndex(e=>e.name===l.name);if(-1!==e){let t=[...P];t[e].quantity+=g,E(t);let l=[...U];l[e].quantity+=g,Y(l)}else E(e=>[...e,{service_id:l.id,quantity:g,cost:l.cost,name:l.name}]),Y(e=>[...e,{service_id:l.id,quantity:g}]);j(1)},sx:{backgroundColor:"#b7b7b7",color:"#181818"},children:"Add"})})]}),P&&(0,a.jsx)("div",{className:"gap-y-2 rounded-md",children:P.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-4 my-2",children:[(0,a.jsx)("div",{className:"text-slate-900 bg-slate-200 rounded-md p-4 w-[80%] text-center",children:e.name}),(0,a.jsx)("div",{className:"text-slate-200 bg-slate-600 rounded-md p-4 w-[10%] text-center",children:e.quantity}),(0,a.jsx)("div",{className:"w-[10%]",children:(0,a.jsx)(d.Z,{onClick:()=>{E(e=>e.filter((e,l)=>l!==t)),Y(e=>e.filter((e,l)=>l!==t))},sx:{backgroundColor:"#1f1f1f",color:"white"},startIcon:(0,a.jsx)(C.Z,{})})})]},t))})]}),(0,a.jsxs)("div",{className:"flex my-5 gap-x-5",children:[(0,a.jsx)("div",{className:"w-[100%]",children:(0,a.jsx)(x,{setSelectedData:e=>c(e),data:null==B?void 0:B.payment_modes,label:"Payment Mode",selectedData:r})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.Z,{onClick:()=>F(!0),sx:{color:"white",backgroundColor:"black"},type:"button",children:"Add Mode"}),(0,a.jsx)(N,{paymentModeModal:T,setPaymentModeModal:F})]}),(0,a.jsxs)("div",{className:"w-[100%]",children:[(0,a.jsx)(x,{setSelectedData:m,data:null==B?void 0:B.payment_terms,label:"Payment Term",selectedData:u}),(0,a.jsx)(M,{paymentTermModal:L,setPaymentTermModal:A})]}),(0,a.jsx)("div",{children:(0,a.jsx)(d.Z,{onClick:()=>A(!0),sx:{color:"white",backgroundColor:"black"},type:"button",children:"Add Term"})})]}),(0,a.jsx)("div",{className:"my-5",children:(0,a.jsx)(v,{label:"Estimated Completion By",value:W,setSelectedData:I})}),(0,a.jsx)("div",{className:"my-5",children:(0,a.jsx)(x,{setSelectedData:p,data:null==B?void 0:B.authorizer,label:"Authorized By",selectedData:f})}),(0,a.jsxs)("div",{className:"flex gap-x-5",children:[(0,a.jsx)(y.Z,{type:"number",id:"filled-basic",label:"Amount",variant:"filled",value:V.total_amount,readOnly:!0}),(0,a.jsx)(y.Z,{type:"number",id:"filled-basic",label:"Paid",variant:"filled",setValue:e=>{let t=parseFloat(e)||0;t<=parseFloat(V.total_amount)?D(t):alert("Paid amount cannot exceed the total amount.")},value:O}),(0,a.jsx)(y.Z,{type:"number",id:"filled-basic",label:"Due",variant:"filled",value:parseFloat(V.total_amount)-(parseFloat(O)||0),readOnly:!0})]}),(0,a.jsx)("div",{className:"bg-black mt-5 h-[5rem]  rounded-sm ",children:(0,a.jsx)(d.Z,{sx:{color:"white"},type:"submit",children:"Generate"})})]})})}},6940:function(e,t,l){"use strict";l.d(t,{p:function(){return o}});var a=l(3919);let o=()=>{let e=(0,a.a)();return{b1:{fontSize:e.fontSize.twelve,fontWeight:e.fontWeight.regular},b2:{fontSize:e.fontSize.fourteen,fontWeight:e.fontWeight.regular},b3:{fontSize:e.fontSize.sixteen,fontWeight:e.fontWeight.regular},b4:{fontSize:e.fontSize.sixteen,fontWeight:e.fontWeight.semiBold},h1:{fontSize:e.fontSize.twentyFour,fontWeight:e.fontWeight.semiBold},h2:{fontSize:e.fontSize.thirtyTwo,fontWeight:e.fontWeight.semiBold},h3:{fontSize:e.fontSize.fourtyEight,fontWeight:e.fontWeight.bold},invoiceMain:{fontSize:e.fontSize.twelve,fontWeight:e.fontWeight.bold},invoicePara:{fontSize:e.fontSize.twelve,fontWeight:e.fontWeight.regular}}}},3919:function(e,t,l){"use strict";l.d(t,{a:function(){return a}});let a=()=>({borderRadius:{two:"0.125rem",five:"0.3125rem",six:"0.375rem",eight:"0.5rem",ten:"0.625rem",twelve:"0.75rem",fifteen:"0.938rem",twentyFour:"1.5rem"},borderWidth:{xs:"1px",sm:"2px",md:"4px",lg:"8px"},boxShadow:{xs:"rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px"},fontWeight:{light:"300",regular:"400",medium:"500",semiBold:"600",bold:"700",bolder:"900"},fontStyle:{normal:"normal",italic:"italic"},fontSize:{twelve:"0.75rem",fourteen:"0.875rem",sixteen:"1rem",twentyFour:"1.4rem",thirtyTwo:"2rem",fourtyEight:"3rem"},textTransform:{default:"capitalize"}})},9901:function(e,t,l){"use strict";l.d(t,{GlobalProvider:function(){return r},O:function(){return i}});var a=l(7437),o=l(2265);let n=(0,o.createContext)(),r=e=>{let{children:t}=e,[l,r]=(0,o.useState)({username:"",password:"",isLoggedIn:!1}),[i,s]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{let e=document.cookie.split(";").reduce((e,t)=>{let[l,a]=t.split("=").map(e=>e.trim());return e[l]=a,e},{});if(e.username&&r(t=>({...t,username:e.username})),e.password&&r(t=>({...t,password:e.password})),e.isLoggedIn){let t=JSON.parse(e.isLoggedIn);r(e=>({...e,isLoggedIn:t}))}},[]),(0,o.useEffect)(()=>{l.username?document.cookie="username=".concat(l.username,"; path=/"):document.cookie="username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",l.password?document.cookie="password=".concat(l.password,"; path=/"):document.cookie="password=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="isLoggedIn=".concat(JSON.stringify(l.isLoggedIn),"; path=/")},[l]),console.log(i,"Login OPen"),console.log(l,"USER"),(0,a.jsx)(n.Provider,{value:{loginOpen:i,setLoginOpen:s,user:l,setUser:r},children:t})},i=()=>(0,o.useContext)(n)}},function(e){e.O(0,[464,657,284,765,974,824,971,117,744],function(){return e(e.s=5164)}),_N_E=e.O()}]);